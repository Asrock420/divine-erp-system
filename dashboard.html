<!DOCTYPE html>
<html>
<head>
  <title>Divine ERP Dashboard</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<div class="layout">

  <!-- Sidebar -->
  <div class="sidebar">
    <h2>Divine ERP</h2>
    <ul id="menuList">
      <li data-role="ALL">Dashboard</li>
      <li data-role="Sales,TL,Admin">Leads</li>
      <li data-role="Sales,TL">Requisitions</li>
      <li data-role="Admin">User Management</li>
      <li data-role="Accounts">Accounts</li>
      <li data-role="CEO">Executive Reports</li>
    </ul>
    <button onclick="logout()">Logout</button>
  </div>

  <!-- Main Content -->
  <div class="main">
    <h1>Dashboard</h1>
    <p id="userInfo"></p>

    <div class="card-container">
      <div class="card">
        <h3>Welcome</h3>
        <p>This is your secure ERP control panel.</p>
      </div>
    </div>
  </div>

</div>

<script>

const user = JSON.parse(sessionStorage.getItem("user"));

// ðŸ” Route Guard
if(!user){
  window.location.href = "index.html";
}

// Show User Info
document.getElementById("userInfo").innerText =
  "Logged in as: " + user.name + " (" + user.role + ")";


// ðŸ”¥ Role Based Menu Control
const menuItems = document.querySelectorAll("#menuList li");

menuItems.forEach(item => {

  const allowedRoles = item.getAttribute("data-role");

  if(allowedRoles !== "ALL") {

    const rolesArray = allowedRoles.split(",");

    if(!rolesArray.includes(user.role)){
      item.style.display = "none";
    }
  }
});


function logout(){
  sessionStorage.clear();
  window.location.href = "index.html";
}

</script>

</body>
</html>